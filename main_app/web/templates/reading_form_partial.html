<!-- Reading Form Partial Template -->
<div class="form-section">
    <h3 class="form-section-title">ğŸ“š Basic Information</h3>
    <div class="form-grid">
        <div class="form-group">
            <label for="user_id" class="form-label required">User</label>
            <select name="user_id" id="user_id" class="form-select" required>
                {% for user in users %}
                <option value="{{ user.id }}" {% if entry and entry.user_id == user.id %}selected{% endif %}>{{ user.display_name }}</option>
                {% endfor %}
            </select>
        </div>

        <div class="form-group">
            <label for="title" class="form-label required">Title</label>
            <input type="text" name="title" id="title" class="form-input" required 
                   placeholder="SnÃ¶frid aus dem Wiesental (1)..."
                   value="{{ entry.title if entry else '' }}">
        </div>

        <div class="form-group">
            <label for="author" class="form-label">Author</label>
            <input type="text" name="author" id="author" class="form-input"
                   placeholder="Andreas H. Schmachtl"
                   value="{{ entry.author if entry and entry.author else '' }}">
        </div>

        <div class="form-group">
            <label for="isbn" class="form-label">ISBN</label>
            <input type="text" name="isbn" id="isbn" class="form-input"
                   placeholder="978-3-401-70581-1"
                   value="{{ entry.isbn if entry and entry.isbn else '' }}">
        </div>
    </div>
</div>

<div class="form-section">
    <h3 class="form-section-title">ğŸ“– Reading Details</h3>
    <div class="form-grid">
        <div class="form-group">
            <label for="reading_type" class="form-label">Type</label>
            <select name="reading_type" id="reading_type" class="form-select" onchange="toggleLengthFields()">
                <option value="PHYSICAL_BOOK" {% if entry and entry.reading_type and entry.reading_type.name == 'PHYSICAL_BOOK' %}selected{% endif %}>ğŸ“š Physical Book</option>
                <option value="AUDIOBOOK" {% if entry and entry.reading_type and entry.reading_type.name == 'AUDIOBOOK' %}selected{% endif %}>ğŸ§ Audiobook</option>
                <option value="EBOOK" {% if entry and entry.reading_type and entry.reading_type.name == 'EBOOK' %}selected{% endif %}>ğŸ“± E-book</option>
                <option value="MAGAZINE" {% if entry and entry.reading_type and entry.reading_type.name == 'MAGAZINE' %}selected{% endif %}>ğŸ“° Magazine</option>
                <option value="COMIC" {% if entry and entry.reading_type and entry.reading_type.name == 'COMIC' %}selected{% endif %}>ğŸ“– Comic</option>
            </select>
        </div>

        <div class="form-group">
            <label for="status" class="form-label">Status</label>
            <select name="status" id="status" class="form-select">
                <option value="PENDING" {% if entry and entry.status and entry.status.name == 'PENDING' %}selected{% endif %}>â³ Pending</option>
                <option value="IN_PROGRESS" {% if entry and entry.status and entry.status.name == 'IN_PROGRESS' %}selected{% endif %}>ğŸ“š In Progress</option>
                <option value="PAUSED" {% if entry and entry.status and entry.status.name == 'PAUSED' %}selected{% endif %}>â¸ï¸ Paused</option>
                <option value="COMPLETED" {% if entry and entry.status and entry.status.name == 'COMPLETED' %}selected{% endif %}>âœ… Completed</option>
                <option value="ABANDONED" {% if entry and entry.status and entry.status.name == 'ABANDONED' %}selected{% endif %}>âŒ Abandoned</option>
            </select>
        </div>

        <div class="form-group" id="length_pages_group">
            <label for="length_pages" class="form-label">Length (pages)</label>
            <input type="number" name="length_pages" id="length_pages" class="form-input"
                   placeholder="240"
                   value="{{ entry.length_pages if entry and entry.length_pages else '' }}">
        </div>

        <div class="form-group" id="length_duration_group">
            <label for="length_duration" class="form-label">Duration (for audiobooks)</label>
            <input type="text" name="length_duration" id="length_duration" class="form-input"
                   placeholder="2h 34m"
                   value="{{ entry.length_duration if entry and entry.length_duration else '' }}">
        </div>
    </div>
</div>

<div class="form-section">
    <h3 class="form-section-title">ğŸ“… Progress & Dates</h3>
    <div class="form-grid">
        <div class="form-group">
            <label for="progress_fraction" class="form-label">Progress (0.0 to 1.0)</label>
            <input type="number" name="progress_fraction" id="progress_fraction" class="form-input"
                   step="0.01" min="0" max="1" placeholder="0.67"
                   value="{{ entry.progress_fraction if entry and entry.progress_fraction else '' }}">
        </div>

        <div class="form-group">
            <label for="started_date" class="form-label">Started Date</label>
            <input type="date" name="started_date" id="started_date" class="form-input"
                   value="{% if entry and entry.started_date %}{{ entry.started_date.strftime('%Y-%m-%d') }}{% endif %}">
        </div>

        <div class="form-group">
            <label for="completed_date" class="form-label">Completed Date</label>
            <input type="date" name="completed_date" id="completed_date" class="form-input"
                   value="{% if entry and entry.completed_date %}{{ entry.completed_date.strftime('%Y-%m-%d') }}{% endif %}">
        </div>

        <div class="form-group">
            <label for="paused_date" class="form-label">Paused Date</label>
            <input type="date" name="paused_date" id="paused_date" class="form-input"
                   value="{% if entry and entry.paused_date %}{{ entry.paused_date.strftime('%Y-%m-%d') }}{% endif %}">
        </div>
    </div>
</div>

<div class="form-section optional">
    <h3 class="form-section-title">
        ğŸ’­ Additional Notes
        <span class="optional-badge">Optional</span>
    </h3>
    <div class="form-grid">
        <div class="form-group full-width">
            <label for="notes" class="form-label">General Notes</label>
            <textarea name="notes" id="notes" class="form-textarea"
                      placeholder="Teil 1 von 12 der SnÃ¶frid aus dem Wiesental Reihe">{{ entry.notes if entry and entry.notes else '' }}</textarea>
        </div>

        <div class="form-group">
            <label for="pause_reason" class="form-label">Pause Reason</label>
            <input type="text" name="pause_reason" id="pause_reason" class="form-input"
                   placeholder="too scary for Simon"
                   value="{{ entry.pause_reason if entry and entry.pause_reason else '' }}">
        </div>

        <div class="form-group">
            <label for="series_info" class="form-label">Series Information</label>
            <textarea name="series_info" id="series_info" class="form-textarea"
                      placeholder="Band 8 der beliebten Kinderbuch-Reihe">{{ entry.series_info if entry and entry.series_info else '' }}</textarea>
        </div>
    </div>
</div>

<script>
function toggleLengthFields() {
    const readingType = document.getElementById('reading_type').value;
    const pagesGroup = document.getElementById('length_pages_group');
    const durationGroup = document.getElementById('length_duration_group');
    const pagesInput = document.getElementById('length_pages');
    const durationInput = document.getElementById('length_duration');
    
    if (readingType === 'AUDIOBOOK') {
        // For audiobooks, show duration and hide pages
        pagesGroup.style.display = 'none';
        durationGroup.style.display = 'block';
        pagesInput.value = '';  // Clear pages field
    } else {
        // For other types, show pages and hide duration
        pagesGroup.style.display = 'block';
        durationGroup.style.display = 'none';
        durationInput.value = '';  // Clear duration field
    }
}

// Initialize the form state when page loads
document.addEventListener('DOMContentLoaded', function() {
    toggleLengthFields();
});
</script>